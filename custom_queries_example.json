[
  {
    "select": ["country", {"SUM": "bid_price"}],
    "from": "events",
    "where": [
      {"col": "type", "op": "eq", "val": "impression"}
    ],
    "group_by": ["country"],
    "order_by": [
      {"col": "SUM(bid_price)", "dir": "desc"}
    ]
  },
  {
    "select": ["type", {"COUNT": "*"}],
    "from": "events",
    "group_by": ["type"]
  },
  {
    "select": ["publisher_id", {"AVG": "bid_price"}],
    "from": "events",
    "where": [
      {"col": "type", "op": "eq", "val": "impression"},
      {"col": "country", "op": "eq", "val": "US"}
    ],
    "group_by": ["publisher_id"],
    "order_by": [
      {"col": "AVG(bid_price)", "dir": "desc"}
    ]
  }
]
